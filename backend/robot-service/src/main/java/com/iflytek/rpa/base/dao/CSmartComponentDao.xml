<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.iflytek.rpa.base.dao.CSmartComponentDao">

    <insert id="createSmartComponentForObtainedVersion">
        insert into c_smart_version (
        smart_id, smart_type, robot_id, robot_version, content, creator_id, updater_id
        ) select
        smart_id, smart_type, #{obtainedRobotDesign.robotId}, 0, content, #{obtainedRobotDesign.creatorId},
        #{obtainedRobotDesign.updaterId}
        from c_smart_version
        where
        robot_id = #{authorRobotVersion.robotId}
        and robot_version = #{authorRobotVersion.version}
        and creator_id = #{authorRobotVersion.creatorId}
    </insert>

    <insert id="insertBatch">
        insert into c_smart_version (
        smart_id, smart_type, robot_id, robot_version, content, creator_id, updater_id
        ) values
        <foreach collection="list" item="item" separator=",">
            (
            #{item.smartId},
            #{item.smartType},
            #{item.robotId},
            #{item.robotVersion},
            #{item.content},
            #{item.creatorId},
            #{item.updaterId}
            )
        </foreach>
    </insert>

    <insert id="createSmartComponentForCurrentVersion">
        insert into c_smart_version(
        smart_id, smart_type, content, robot_id, robot_version, creator_id, updater_id
        ) select
        smart_id, smart_type, content, robot_id, #{version}, creator_id, updater_id
        from c_smart_version
        where
        robot_id = #{robotId}
        and creator_id = #{creatorId}
        and robot_version = 0
        and deleted = 0
    </insert>
</mapper>

